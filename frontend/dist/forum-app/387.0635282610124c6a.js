"use strict";(self.webpackChunkforum_app=self.webpackChunkforum_app||[]).push([[387],{8387:(B,g,e)=>{e.r(g),e.d(g,{EditPostPageComponent:()=>Z});var t=e(5879),_=e(6814),h=e(268),E=e(9450),a=e(1e3),P=e(3568),u=e(8645),x=e(5592),l=e(9773),r=e(6223),m=e(707),p=e(411),f=e(3714),d=e(6218),v=e(1532);function C(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",15)(2,"label",16),t._uU(3,"Category"),t.qZA(),t._UZ(4,"p-dropdown",17)(5,"div",7),t.qZA(),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(4),t.Q6J("showClear",!0)("options",o.categories)}}function T(n,i){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function I(n,i){1&n&&(t.ynx(0),t._uU(1," Max length is 32 "),t.BQk())}function M(n,i){if(1&n&&(t.ynx(0),t.YNc(1,T,2,0,"ng-container",1),t.YNc(2,I,2,0,"ng-container",1),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",o.errors.required),t.xp6(1),t.Q6J("ngIf",!o.errors.required&&o.errors.maxlength)}}function y(n,i){if(1&n&&(t.ynx(0),t.YNc(1,M,3,2,"ng-container",1),t.BQk()),2&n){const o=i.ngIf;t.xp6(1),t.Q6J("ngIf",o.errors&&o.dirty)}}function O(n,i){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function D(n,i){if(1&n&&(t.ynx(0),t.YNc(1,O,2,0,"ng-container",1),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",o.errors.required)}}function U(n,i){if(1&n&&(t.ynx(0),t.YNc(1,D,2,1,"ng-container",1),t.BQk()),2&n){const o=i.ngIf;t.xp6(1),t.Q6J("ngIf",o.errors&&o.dirty)}}function A(n,i){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.onSubmit())}),t.TgZ(2,"h2"),t._uU(3,"Edit post"),t.qZA(),t._UZ(4,"app-error",3),t.ALo(5,"async"),t.YNc(6,C,6,2,"ng-container",1),t.TgZ(7,"div",4)(8,"label",5),t._uU(9,"Title"),t.qZA(),t._UZ(10,"input",6),t.TgZ(11,"div",7),t.YNc(12,y,2,1,"ng-container",1),t.qZA()(),t.TgZ(13,"div",8)(14,"label",9),t._uU(15,"Content"),t.qZA(),t._UZ(16,"textarea",10),t.TgZ(17,"div",7),t.YNc(18,U,2,1,"ng-container",1),t.qZA()(),t._UZ(19,"div",11),t.TgZ(20,"div",12)(21,"button",13),t._uU(22," Cancel "),t.qZA(),t.TgZ(23,"button",14),t._uU(24,"Save"),t.qZA()()(),t.BQk()}if(2&n){const o=i.ngIf,s=t.oxw();t.xp6(1),t.Q6J("formGroup",s.form),t.xp6(3),t.Q6J("errorMessage",t.lcZ(5,7,s.error$)),t.xp6(2),t.Q6J("ngIf",o.categories.length>0),t.xp6(6),t.Q6J("ngIf",s.form.controls.title),t.xp6(4),t.Q6J("autoResize",!0),t.xp6(2),t.Q6J("ngIf",s.form.controls.content),t.xp6(3),t.MGl("routerLink","../../",s.id,"")}}let Z=(()=>{class n{constructor(){this.destroy$=new u.x,this.error$=new u.x,this.forumsService=(0,t.f3M)(h.z),this.postsService=(0,t.f3M)(E.P),this.route=(0,t.f3M)(a.gz),this.router=(0,t.f3M)(a.F0),this.formUtils=(0,t.f3M)(P.F),this.id=0,this.forum$=new x.y,this.form=new r.cw({category:new r.NI(null,{}),title:new r.NI("",{nonNullable:!0,validators:[r.kI.required,r.kI.maxLength(32)]}),content:new r.NI("",{nonNullable:!0,validators:[r.kI.required]})})}ngOnInit(){this.forum$=this.forumsService.getForum(this.route.snapshot.params.id),this.postsService.getPost(this.route.snapshot.params.post).pipe((0,l.R)(this.destroy$)).subscribe({next:o=>{o.category&&this.form.get("category")?.setValue(o.category.id),this.id=o.id,this.form.get("title")?.setValue(o.title),this.form.get("content")?.setValue(o.content)}})}onSubmit(){this.error$.next(""),this.form.valid?this.postsService.updatePost({title:this.form.controls.title.getRawValue(),content:this.form.controls.content.getRawValue(),categoryId:this.form.controls.category.getRawValue()},this.id).pipe((0,l.R)(this.destroy$)).subscribe({next:()=>this.router.navigate([`../../${this.id}`],{relativeTo:this.route}),error:o=>{this.formUtils.handleSubmitError(o,this.form,this.error$)}}):this.formUtils.markGroupDirty(this.form)}ngOnDestroy(){this.destroy$.next(!0)}static#t=this.\u0275fac=function(s){return new(s||n)};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-edit-post-page"]],standalone:!0,features:[t.jDz],decls:3,vars:3,consts:[["ontouchstart","",1,"card"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[3,"errorMessage"],[1,"input"],["for","title"],["pInputText","","type","text","id","title","formControlName","title","placeholder","Title"],[1,"error"],[1,"input-last"],["for","content"],["rows","5","id","content","formControlName","content","cols","30","pInputTextarea","",3,"autoResize"],[1,"top-error"],[1,"double-submit"],["pButton","","type","button",1,"p-button","p-button-outlined",3,"routerLink"],["pButton","",1,"p-button"],[1,"input","mt-3"],["for","category"],["placeholder","Category","id","category","formControlName","category","optionLabel","name","optionValue","id",3,"showClear","options"]],template:function(s,c){1&s&&(t.TgZ(0,"div",0),t.YNc(1,A,25,9,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&s&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,c.forum$)))},dependencies:[_.ez,_.O5,_.Ov,m.hJ,m.Hq,p.kW,p.Lt,f.j,f.o,d.A,d.g,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,a.rH,v.q],styles:[".card[_ngcontent-%COMP%]{max-width:50rem}"],changeDetection:0})}return n})()}}]);