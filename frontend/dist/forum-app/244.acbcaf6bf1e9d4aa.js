"use strict";(self.webpackChunkforum_app=self.webpackChunkforum_app||[]).push([[244],{244:(D,d,o)=>{o.r(d),o.d(d,{EditForumPageComponent:()=>A});var t=o(5879),g=o(6814),f=o(1480),p=o(707),l=o(3250),u=o(355),i=o(6223),m=o(1e3),E=o(268),c=o(8645),h=o(9773),v=o(3714);function y(n,a){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function C(n,a){if(1&n&&(t.ynx(0),t.YNc(1,y,2,0,"ng-container",6),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.forumName.errors.required)}}function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",21)(2,"div",22),t._uU(3),t.qZA(),t.TgZ(4,"div",23)(5,"button",24),t.NdJ("click",function(){const r=t.CHM(e),_=r.$implicit,Z=r.index,M=t.oxw(2);return t.KtG(M.deleteCategory(_,Z))}),t._UZ(6,"ng-icon",25),t.qZA()()()()}if(2&n){const e=a.$implicit;t.xp6(3),t.Oqu(e.name)}}function x(n,a){if(1&n&&(t.ynx(0),t.YNc(1,P,7,1,"div",20),t.BQk()),2&n){const e=a.ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}function T(n,a){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function O(n,a){if(1&n&&(t.ynx(0),t.YNc(1,T,2,0,"ng-container",6),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.categoryName.errors.required)}}let A=(()=>{class n{constructor(){this.destroy$=new c.x,this.route=(0,t.f3M)(m.gz),this.router=(0,t.f3M)(m.F0),this.forumsService=(0,t.f3M)(E.z),this.categories=[],this.categoriesDeleted=[],this.categoriesAdded=[],this.categories$=new c.x,this.errors$=new c.x,this.categoryName=new i.NI("",{nonNullable:!0,updateOn:"blur",validators:[i.kI.required]}),this.forumName=new i.NI("",{nonNullable:!0,validators:[i.kI.required]})}ngOnInit(){this.forumsService.getForumForEdit(this.route.snapshot.params.id).pipe((0,h.R)(this.destroy$)).subscribe({next:e=>{this.forum=e,this.categories=e.categories,this.categories$.next(this.categories),this.forumName.patchValue(e.name)}})}addCategory(){this.categoryName.valid?(this.categoriesAdded.push({name:this.categoryName.getRawValue()}),this.categories.push({name:this.categoryName.getRawValue(),id:-1}),this.categories$.next(this.categories),this.categoryName.reset()):this.categoryName.markAsDirty()}deleteCategory(e,s){this.categories.splice(s,1),this.categories$.next(this.categories),e.id>0?this.categoriesDeleted.push(e):this.categoriesAdded.splice(this.categoriesAdded.findIndex(r=>r.name==e.name),1)}onSubmit(){this.forumName.valid?this.forumsService.updateForum(this.route.snapshot.params.id,{name:this.forumName.getRawValue(),deletedCategories:this.categoriesDeleted,addedCategories:this.categoriesAdded}).pipe((0,h.R)(this.destroy$)).subscribe({next:()=>this.router.navigate(["forums"]),error:e=>{this.errors$.next(e.message)}}):(this.forumName.markAsDirty(),this.categoryName.markAsPristine())}ngOnDestroy(){this.destroy$.next(!0)}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-new-forum-page"]],standalone:!0,features:[t._Bn([],[(0,l.kp)({jamPlus:u.sJe,jamTrashF:u.Xay,jamPencilF:u.ajg})]),t.jDz],decls:36,vars:10,consts:[["ontouchstart","",1,"card"],[3,"ngSubmit"],[1,"input"],["for","name"],["pInputText","","type","text","id","name",3,"formControl"],[1,"error"],[4,"ngIf"],[1,"separator"],[1,"categories"],[1,"subtitle"],[1,"input-last"],["for","category"],[1,"p-inputgroup"],["id","category","type","text","pInputText","","placeholder","Category name",3,"formControl"],["type","button","pButton","",3,"click"],["name","jamPlus","size","1.3rem"],[1,"top-error"],[1,"double-submit"],["pButton","","type","button","routerLink","../..",1,"p-button","p-button-outlined"],["pButton","",1,"p-button"],[4,"ngFor","ngForOf"],[1,"category"],[1,"text"],[1,"btns"],["pButton","","type","button",1,"nav","p-button","p-button-text","p-button-danger",3,"click"],["name","jamTrashF"]],template:function(s,r){1&s&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(2,"h2"),t._uU(3,"Edit forum"),t.qZA(),t.TgZ(4,"div",2)(5,"label",3),t._uU(6,"Forum name"),t.qZA(),t._UZ(7,"input",4),t.TgZ(8,"div",5),t.YNc(9,C,2,1,"ng-container",6),t.qZA()(),t._UZ(10,"div",7)(11,"div",5),t.TgZ(12,"div",8)(13,"div",9),t._uU(14,"Category"),t.qZA(),t.YNc(15,x,2,1,"ng-container",6),t.ALo(16,"async"),t.qZA(),t._UZ(17,"div",5),t.TgZ(18,"div",10)(19,"label",11),t._uU(20,"Add category"),t.qZA(),t.TgZ(21,"div",12),t._UZ(22,"input",13),t.TgZ(23,"button",14),t.NdJ("click",function(){return r.addCategory()}),t._uU(24," Add "),t._UZ(25,"ng-icon",15),t.qZA()(),t.TgZ(26,"div",5),t.YNc(27,O,2,1,"ng-container",6),t.qZA()(),t.TgZ(28,"div",16),t._uU(29),t.ALo(30,"async"),t.qZA(),t.TgZ(31,"div",17)(32,"button",18),t._uU(33," Cancel "),t.qZA(),t.TgZ(34,"button",19),t._uU(35,"Save"),t.qZA()()()()),2&s&&(t.xp6(7),t.Q6J("formControl",r.forumName),t.xp6(2),t.Q6J("ngIf",r.forumName.errors),t.xp6(6),t.Q6J("ngIf",t.lcZ(16,6,r.categories$)),t.xp6(7),t.Q6J("formControl",r.categoryName),t.xp6(5),t.Q6J("ngIf",r.categoryName.errors&&r.categoryName.dirty),t.xp6(2),t.Oqu(t.lcZ(30,8,r.errors$)))},dependencies:[g.ez,g.sg,g.O5,g.Ov,f.Gg,v.o,p.hJ,p.Hq,l.sZ,i.u5,i._Y,i.Fj,i.JJ,i.JL,i.F,i.UX,i.oH,m.rH],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--text-gray)}.categories[_ngcontent-%COMP%]{transition:height .2s}.category[_ngcontent-%COMP%]{border-bottom:1px solid var(--border);margin:.5rem 0;display:flex;justify-content:space-between;align-items:center}.btns[_ngcontent-%COMP%]{display:flex;align-items:center}.card[_ngcontent-%COMP%]{max-width:70rem;transition:height 2s}@media (min-width: 768px){.card[_ngcontent-%COMP%]{padding-left:8rem;padding-right:8rem;padding-bottom:3rem}}"],changeDetection:0})}return n})()}}]);