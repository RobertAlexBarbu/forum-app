"use strict";(self.webpackChunkforum_app=self.webpackChunkforum_app||[]).push([[318],{9318:(Z,g,e)=>{e.r(g),e.d(g,{NewPostPageComponent:()=>B});var t=e(5879),a=e(6814),u=e(411),p=e(268),c=e(1e3),l=e(8645),P=e(5592),d=e(9773),r=e(6223),h=e(1480),m=e(6218),f=e(707),x=e(9450),E=e(3568),C=e(1532),I=e(3714);function T(n,_){if(1&n&&(t.ynx(0),t.TgZ(1,"div",4)(2,"label",15),t._uU(3,"Category"),t.qZA(),t._UZ(4,"p-dropdown",16)(5,"div",7),t.qZA(),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(4),t.Q6J("showClear",!0)("options",o.categories)}}function v(n,_){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function M(n,_){1&n&&(t.ynx(0),t._uU(1," Max length is 32 "),t.BQk())}function O(n,_){if(1&n&&(t.ynx(0),t.YNc(1,v,2,0,"ng-container",1),t.YNc(2,M,2,0,"ng-container",1),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",o.errors.required),t.xp6(1),t.Q6J("ngIf",!o.errors.required&&o.errors.maxlength)}}function D(n,_){if(1&n&&(t.ynx(0),t.YNc(1,O,3,2,"ng-container",1),t.BQk()),2&n){const o=_.ngIf;t.xp6(1),t.Q6J("ngIf",o.errors&&o.dirty)}}function y(n,_){1&n&&(t.ynx(0),t._uU(1," This field is required "),t.BQk())}function U(n,_){if(1&n&&(t.ynx(0),t.YNc(1,y,2,0,"ng-container",1),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",o.errors.required)}}function N(n,_){if(1&n&&(t.ynx(0),t.YNc(1,U,2,1,"ng-container",1),t.BQk()),2&n){const o=_.ngIf;t.xp6(1),t.Q6J("ngIf",o.errors&&o.dirty)}}function A(n,_){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.onSubmit())}),t.TgZ(2,"h2"),t._uU(3,"New post"),t.qZA(),t._UZ(4,"app-error",3),t.ALo(5,"async"),t.YNc(6,T,6,2,"ng-container",1),t.TgZ(7,"div",4)(8,"label",5),t._uU(9,"Title"),t.qZA(),t._UZ(10,"input",6),t.TgZ(11,"div",7),t.YNc(12,D,2,1,"ng-container",1),t.qZA()(),t.TgZ(13,"div",8)(14,"label",9),t._uU(15,"Content"),t.qZA(),t._UZ(16,"textarea",10),t.TgZ(17,"div",7),t.YNc(18,N,2,1,"ng-container",1),t.qZA()(),t._UZ(19,"div",11),t.TgZ(20,"div",12)(21,"button",13),t._uU(22," Cancel "),t.qZA(),t.TgZ(23,"button",14),t._uU(24,"Save"),t.qZA()()(),t.BQk()}if(2&n){const o=_.ngIf,i=t.oxw();t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(3),t.Q6J("errorMessage",t.lcZ(5,6,i.error$)),t.xp6(2),t.Q6J("ngIf",o.categories.length>0),t.xp6(6),t.Q6J("ngIf",i.form.controls.title),t.xp6(4),t.Q6J("autoResize",!0),t.xp6(2),t.Q6J("ngIf",i.form.controls.content)}}let B=(()=>{class n{constructor(){this.destroy$=new l.x,this.error$=new l.x,this.forumsService=(0,t.f3M)(p.z),this.postsService=(0,t.f3M)(x.P),this.route=(0,t.f3M)(c.gz),this.router=(0,t.f3M)(c.F0),this.formUtils=(0,t.f3M)(E.F),this.forum$=new P.y,this.form=new r.cw({category:new r.NI(null,{}),title:new r.NI("",{nonNullable:!0,validators:[r.kI.required,r.kI.maxLength(32)]}),content:new r.NI("",{nonNullable:!0,validators:[r.kI.required]})})}ngOnInit(){this.forum$=this.forumsService.getForum(this.route.snapshot.params.id)}onSubmit(){if(this.error$.next(""),this.form.valid){let o=null;const i=this.form.controls.category.getRawValue();i&&(o=i.id),this.postsService.createPost({title:this.form.controls.title.getRawValue(),content:this.form.controls.content.getRawValue(),forumId:+this.route.snapshot.params.id,categoryId:o}).pipe((0,d.R)(this.destroy$)).subscribe({next:()=>this.router.navigate(["../"],{relativeTo:this.route}),error:s=>{this.formUtils.handleSubmitError(s,this.form,this.error$)}})}else this.formUtils.markGroupDirty(this.form)}ngOnDestroy(){this.destroy$.next(!0)}static#t=this.\u0275fac=function(i){return new(i||n)};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-new-post-page"]],standalone:!0,features:[t.jDz],decls:3,vars:3,consts:[["ontouchstart","",1,"card"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[3,"errorMessage"],[1,"input"],["for","title"],["pInputText","","type","text","id","title","formControlName","title","placeholder","Title"],[1,"error"],[1,"input-last"],["for","content"],["rows","5","id","content","formControlName","content","cols","30","pInputTextarea","",3,"autoResize"],[1,"top-error"],[1,"double-submit"],["pButton","","type","button","routerLink","../",1,"p-button","p-button-outlined"],["pButton","",1,"p-button"],["for","category"],["id","category","formControlName","category","optionLabel","name","placeholder","Category",3,"showClear","options"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t.YNc(1,A,25,8,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,s.forum$)))},dependencies:[a.ez,a.O5,a.Ov,u.kW,u.Lt,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,h.Gg,I.o,m.A,m.g,f.hJ,f.Hq,c.rH,C.q],styles:[".card[_ngcontent-%COMP%]{max-width:50rem}"],changeDetection:0})}return n})()}}]);